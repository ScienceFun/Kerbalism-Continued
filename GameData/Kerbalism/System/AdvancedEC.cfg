// ============================================================================
// Supported Modules List
//  - Antenna(Kerbalism): add ecCost for all Kerbalism antennas to stay connected, add ecCost when the animation(Extending/Retracting) is playing
//  - RetractableLadder: add ecDeploy for all parts that has RetractableLadder module.
//  - ModuleDataTransmitter: *(add ecCost for all stock antennas to stay connected), add ecCost when the animation(Extending/Retracting) is playing.
//
//
//
//  extra_Cost = extra_Cost to keep module working
//  ecDeploy = ecCost to Extend\Retract(animation)
//  *= About stay connected, only works when the game using ModuleDataTransmitter, if the game uses the simple signal system, it won't interrupt the communication.
//  The modules are always being added to support ActionGroups
//  If DeploySystem is Off, the code will only enable the actionGroup if they were disable by DeploySystem
// ============================================================================

// ============================================================================
// add ecCost to stock antennas, I'm using 10% of antenna.cost
// ============================================================================

// region ANTENNA
@PART[kerbalism-antenna]:HAS[@MODULE[Antenna]]:NEEDS[FeatureAdvancedEC,FeatureSignal]:AFTER[Kerbalism-Continued]
{
  MODULE
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.001
    extra_Deploy = 0.02
  }
}
@PART[longAntenna]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.002
    extra_Deploy = 0.03
    antennaPower = 0
  }
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.002
    extra_Deploy = 0.03
    antennaPower = 0
  }
}

@PART[SurfAntenna]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.002
    antennaPower = 0
  }
    MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.002
    extra_Deploy = 0.03
    antennaPower = 0
  }
}

@PART[mediumDishAntenna]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.003
    extra_Deploy = 0.12
    antennaPower = 0
  }
    MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.003
    extra_Deploy = 0.12
    antennaPower = 0
  }
}

@PART[HighGainAntenna5]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.003
    extra_Deploy = 0.08
    antennaPower = 0
  }
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.003
    extra_Deploy = 0.08
    antennaPower = 0
  }
}

@PART[HighGainAntenna]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.004
    extra_Deploy = 0.2
    antennaPower = 0
  }
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.004
    extra_Deploy = 0.2
    antennaPower = 0
  }
}

@PART[commDish]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.005
    extra_Deploy = 0.22
  }
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.005
    extra_Deploy = 0.22
  }
}

@PART[RelayAntenna5]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.004
    antennaPower = 0
  }
    MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.004
    antennaPower = 0
  }
}

@PART[RelayAntenna50]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.005
    antennaPower = 0
  }
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.005
    antennaPower = 0
  }
}

@PART[RelayAntenna100]:NEEDS[FeatureAdvancedEC]:FOR[Kerbalism-Continued]
{
  MODULE:NEEDS[FeatureSignal]
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.007
    antennaPower = 0
  }
    MODULE:NEEDS[!FeatureSignal]
  {
    name = AdvancedEC
    type = Antenna
    extra_Cost = 0.007
    antennaPower = 0
  }
}

// ============================================================================
// add ecCost to internal stock antennas
// ============================================================================

@PART[*]:HAS[@MODULE[ModuleDataTransmitter]:HAS[#antennaType[INTERNAL]]]:NEEDS[FeatureAdvancedEC&!FeatureSignal]:FINAL
{
  MODULE
  {
    name = AdvancedEC
    type = ModuleDataTransmitter
    extra_Cost = 0.001
    antennaPower = 0
  }
}

// Add support to TweakScale
TWEAKSCALEEXPONENTS:NEEDS[FeatureAdvancedEC]
{
  name = AdvancedEC
  extra_Cost = 2
  extra_Deploy = 2
}
// end

// ============================================================================
// add ecCost for deploy Ladder
// ============================================================================

@PART[*]:HAS[@MODULE[RetractableLadder]]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = LadderDeploy
    ecDeploy = 0.13
  }
}

// ============================================================================
// add ecCost to deploy LandingGear
// ============================================================================

// region LANDINGGEAR
@PART[*]:HAS[@MODULE[ModuleWheelDeployment]]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = LandingGearDeploy
    ecDeploy = 0.01
  }
}

@PART[miniLandingLeg]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.02
  }
}

@PART[landingLeg1]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.04
  }
}

@PART[landingLeg1-2]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.06
  }
}

@PART[SmallGearBay]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.06
  }
}

@PART[GearSmall]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.1
  }
}

@PART[GearMedium]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.16
  }
}

@PART[GearLarge]:HAS[@MODULE[LandingGearDeploy]]:AFTER[Kerbalism-Continued]
{
  @MODULE[LandingGearDeploy]
  {
    @ecDeploy = 0.22
  }
}

// Add support to TweakScale
TWEAKSCALEEXPONENTS:NEEDS[FeatureDeploy]
{
  name = LandingGearDeploy
  ecDeploy = 2
}

// end

// ============================================================================
// add ecCost to keep Lights ON
// ============================================================================

@PART[*]:HAS[@MODULE[ModuleAnimateGeneric]:HAS[#defaultActionGroup[Light]]]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = LightsDeploy
    ecCost = 0.01
  }
}

@PART[*]:HAS[@MODULE[ModuleColorChanger]:HAS[#defaultActionGroup[Light]]]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = LightsDeploy
    ecCost = 0.01
  }
}

// ============================================================================
// add ecCost to deploy Drill
// ============================================================================

@PART[MiniDrill]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = DrillDeploy
    ecDeploy = 0.09
  }
}

@PART[RadialDrill]:FOR[Kerbalism-Continued]
{
  MODULE
  {
    name = DrillDeploy
    ecDeploy = 0.3
  }
}

// ============================================================================
// add ecCost to deploy Science
// TODO
// ============================================================================